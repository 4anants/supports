generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id       String   @id @default(uuid())
  email    String   @unique
  username String   @unique
  name     String?
  password String
  role     String   @default("IT Support")
  avatar   String?
  created  DateTime @default(now())
  updated  DateTime @updatedAt
}

model Ticket {
  id                String    @id @default(uuid())
  generated_id      String    @unique
  requester_email   String
  full_name         String
  computer_name     String?
  ip_address        String?
  department        String?
  priority          String    @default("Medium")
  office            String?
  type              String    @default("SUPPORT_ISSUE")
  description       String
  request_item_type String?
  attachment_path   String?
  status            String    @default("Open")
  resolved_at       DateTime?
  resolved_by       String?
  responded_at      DateTime?
  admin_remarks     String?
  created           DateTime  @default(now())
  updated           DateTime  @updatedAt
}

model Inventory {
  id              String   @id @default(uuid())
  item_name       String
  category        String
  office_location String
  quantity        Int      @default(0)
  min_threshold   Int      @default(5)
  created         DateTime @default(now())
  updated         DateTime @updatedAt
  lastModifiedBy  String?
  lastLowStockEmail DateTime?
}

model InventoryLog {
  id        String   @id @default(uuid())
  itemId    String
  itemName  String
  office    String
  change    Int
  type      String
  reason    String?
  performedBy String?
  timestamp DateTime @default(now())
}

model Settings {
  id    String @id @default(uuid())
  key   String @unique
  value String
}

model Office {
  id      String   @id @default(uuid())
  name    String   @unique
  created DateTime @default(now())
}

model Department {
  id      String   @id @default(uuid())
  name    String   @unique
  order   Int?
  created DateTime @default(now())
}

model BackupLog {
  id        String   @id @default(uuid())
  timestamp DateTime @default(now())
  status    String   // 'SUCCESS' | 'FAILED'
  type      String   // 'LOCAL' | 'CLOUD' | 'HYBRID'
  details   String?
  path      String?
}
